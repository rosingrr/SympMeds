package com.example.sympmeds;

import java.io.IOException;
import java.io.InputStream;

import jxl.Workbook;
import jxl.read.biff.BiffException;
import android.app.Activity;
import android.content.Intent;
import android.content.res.AssetManager;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;

/*
 * This is the starting activity that shows a disclaimer and a Start button that opens the next activity
 */
public class MainActivity extends Activity {
	//holds the database excel file as a public variable so that it doesn't have to be constantly opened
	public static Workbook database;

	/**onCreate() is called when the MainActivity activity is started,
	 * which is at the start of the application.
	 * This is default code generated by Eclipse
	 */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
		//this is default code
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
		//open the Database excel file from assets folder
        //open assetManager
		AssetManager assetManager = getResources().getAssets();
		InputStream inputStream = null;
		try{
			//open Database file in inputStream
			inputStream = assetManager.open("Database.xls");
		} catch(IOException e) {
			//e.printStackTrace();
		}
		try{
			try {
				//save workbook from file into public variable
				database = Workbook.getWorkbook(inputStream);

			} catch (IOException e) {
				//e.printStackTrace();
			}
		} catch(BiffException e) {
			//e.printStackTrace();
		}
		try {
			//close input stream
			inputStream.close();
		} catch (IOException e) {
			//e.printStackTrace();
		}
    }

    /**
     * This was generated by default by Eclipse
     */
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }
    
    /** Called when the user clicks the Search button.
     * It calls up the SymptomList activity.
     */
    public void start (View view) {
    	// Do something in response to button
		Intent intent = new Intent(this, SymptomList.class);
		startActivity(intent);
    }
}