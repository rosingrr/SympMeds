package com.example.sympmeds;

import java.io.IOException;
import java.io.InputStream;

import jxl.Workbook;
import jxl.read.biff.BiffException;
import android.app.Activity;
import android.content.Intent;
import android.content.res.AssetManager;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity {
	public static Workbook database;

	/**onCreate() is called when the MainActivity activity is started,
	 * which is at the start of the application.
	 * This is default code generated by Eclipse
	 */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
		//open the Database excel file from assets folder
		AssetManager assetManager = getResources().getAssets();
		InputStream inputStream = null;
		try{
			inputStream = assetManager.open("Database.xls");
		} catch(IOException e) {
			//Log.e("SYMPMEDS", "error 1");
			e.printStackTrace();
		}
		//Log.v("SYMPMEDS", inputStream.toString());
		database = null;
		try{
			try {
				database = Workbook.getWorkbook(inputStream);
				//Log.v("SYMPMEDS", "wb = workbook worked");

			} catch (IOException e) {
				//Log.e("SYMPMEDS", "error 2");
				e.printStackTrace();
			}
		} catch(BiffException e) {
			//Log.e("SYMPMEDS", "error 3");
			e.printStackTrace();
		}
		//close input stream
		try {
			inputStream.close();
			//Log.v("SYMPMEDS", "inputStream.close() worked");
		} catch (IOException e) {
			//Log.e("SYMPMEDS", "error 4");
			e.printStackTrace();
		}
    }

    /**
     * This was generated by default by Eclipse
     */
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }
    
    /** Called when the user clicks the Search button.
     * It calls up the SymptomList activity.
     */
    public void start (View view) {
    	// Do something in response to button}
		Intent intent = new Intent(this, SymptomList.class);
		startActivity(intent);
    }
}